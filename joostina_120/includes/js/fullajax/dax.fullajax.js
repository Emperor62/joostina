/**
* Fullajax = AJAX & AHAH library
* http://www.fullajax.ru
* SiRusAjaX - SRAX v1.0.3 build 1 (dax)
* Copyright(c) 2007-2009, Ruslan Sinitskiy.
* http://fullajax.ru/#:license
**/
if(!window.SRAX||window.SRAX.TYPE!="full"){function log(){SRAX.debug("log",arguments)}function info(){SRAX.debug("info",arguments)}function error(){SRAX.debug("error",arguments)}function warn(){SRAX.debug("warn",arguments)}function id(A){return SRAX.get(A)}String.prototype.endWith=function(B,A){return A?(this.toLowerCase().substring(this.length-B.length,this.length)==B.toLowerCase()):(this.substring(this.length-B.length,this.length)==B)};String.prototype.startWith=function(B,A){return A?(this.toLowerCase().substring(0,B.length)==B.toLowerCase()):(this.substring(0,B.length)==B)};function dax(C,B){if(!B){B={}}if(typeof C=="string"){B.url=C}else{B=C}if(!B.id){B.id="undefined"}var A=SRAX.Data.thread[B.id]?SRAX.Data.thread[B.id]:new SRAX.DATAThread(B.id);A.setOptions(B,1);A.request();return A}function abortData(A){if(SRAX.Data.thread[A]){SRAX.Data.thread[A].abort()}}function getData(B,A,F,D,E,C){return dax(B,{cb:A,id:F,cbo:D,anticache:E,destroy:C})}function postData(B,E,A,G,D,F,C){return dax(B,{method:"post",params:E,cb:A,id:G,cbo:D,anticache:F,destroy:C})}if(!window.SRAX){SRAX={}}SRAX.extend=function(B,E,D){var A=!D;for(var C in E){if(A||!B.hasOwnProperty(C)){B[C]=E[C]}}return B};(function(B){B.extend(B,{version:"SRAX v1.0.3 build 1",TYPE:"dax",Default:{prefix:"ax",sprt:":",loader:"loading",loader2:"loading2",loaderSufix:"_loading",DEBUG_AJAX:0,DAX_AUTO_DESTROY:0,DAX_ANTICACHE:0,CHARSET:"UTF-8"},debug:function(J,G){var K=window.console;if(K&&K[J]){try{K[J].apply(K,G)}catch(I){K[J](G.length==1?G[0]:G)}}else{if(window.runtime){var F=[J+": "+G[0]];for(var H=1,D=G.length;H<D;H++){F.push(G[H])}runtime.trace(F)}}},getTime:function(){return new Date().getTime()},init:function(){var D=navigator.userAgent.toLowerCase();B.browser={version:(D.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],webkit:/webkit/.test(D),safari:/safari/.test(D),opera:/opera/.test(D),msie:/msie/.test(D)&&!/opera/.test(D),mozilla:/mozilla/.test(D)&&!/(compatible|webkit)/.test(D),air:/adobeair/.test(D)};var F="addEventsListener";B[F](B.DATAThread);F="addContainerListener";B[F](B.Data)},initOnReady:function(){if(B.isReadyInited){return }B.isReadyInited=1;if(B.browser.mozilla||B.browser.opera){B.addEvent(document,"DOMContentLoaded",B.ready)}else{if(B.browser.msie){(function(){try{document.documentElement.doScroll("left")}catch(D){setTimeout(arguments.callee,50);return }B.ready()})()}else{if(B.browser.safari){B.safariTimer=setInterval(function(){if(document.readyState=="loaded"||document.readyState=="complete"){clearInterval(B.safariTimer);B.safariTimer=null;B.ready()}},10)}}}B.addEvent(window,"load",B.ready)},onReady:function(D){if(B.isReady){D()}else{B.readyHndlr.push(D);B.initOnReady()}},ready:function(){if(B.isReady){return }B.isReady=1;for(var G=0,D=B.readyHndlr.length;G<D;G++){try{B.readyHndlr[G]()}catch(F){error(F)}}B.readyHndlr=null},get:function(D){return typeof D=="string"?document.getElementById(D):D},IE_XHR_ENGINE:["Msxml2.XMLHTTP","Microsoft.XMLHTTP"],getXHR:function(){if(window.XMLHttpRequest&&!(window.ActiveXObject&&location.protocol=="file:")){return new XMLHttpRequest()}else{if(window.ActiveXObject){for(var D=0;D<B.IE_XHR_ENGINE.length;D++){try{return new ActiveXObject(B.IE_XHR_ENGINE[D])}catch(F){}}}}},delHost:function(D){if(D&&D.startWith(B.host)){D=D.replace(B.host,"")}return D},host:location.protocol+"//"+location.host,DaxPreprocessor:function(D){},DATAThread:function(J){var H,G,I=this,F=this.options={};this.inprocess=0;this.id=J;B.Data.thread[J]=this;B.Data.register(this);this.repeat=function(K){F.params=K;I.request()};this.setOptions=function(L,K){if(!L.url){L.url=L.src}if(!L.cb){L.cb=L.callback}if(L.cbo==null){L.cbo=L.callbackOps}if(L.anticache==null){L.anticache=L.nocache}if(K){F={}}B.extend(F,L);if(F.async==null){F.async=true}F.url=B.delHost(F.url);this.options=F};this.getOptions=function(){return F};function D(N){if(!N||!N.readyState){N=H}try{if(N.readyState==4){I.inprocess=0;B.showLoading(I.inprocess,I.getLoader());var K=N.isAbort?-1:N.status,Q=(K>=200&&K<300)||K==304||(K==0&&location.protocol=="file:"),P=N.responseText,L=N.responseXML,O={xhr:N,url:F.url,id:J,status:K,success:Q,cbo:F.cbo,callbackOps:F.cbo,options:F,text:P,xml:L,thread:I,responseText:P,responseXML:L,time:B.getTime()-G};I.fireEvent("response",O);if(K>-1&&B.DaxPreprocessor(O)!==false&&F.cb){F.cb(O,J,Q,F.cbo);if(C.DEBUG_AJAX){log("callback id:"+J)}}if((F.destroy!=null)?F.destroy:C.DAX_AUTO_DESTROY){I.destroy()}}}catch(M){error(M);I.fireEvent("exception",{xhr:N,url:F.url,id:J,exception:M,options:F});I.inprocess=0;B.showLoading(I.inprocess,I.getLoader());if((F.destroy!=null)?F.destroy:C.DAX_AUTO_DESTROY){I.destroy()}}}this.isProcess=function(){return I.inprocess};this.request=function(){var L=F.method?F.method:(F.form?F.form.method:"get"),R=(L&&L.toLowerCase()=="post")?"post":"get";try{var O={url:F.url,id:J,options:F,xhr:I};if(I.fireEvent("beforerequest",O)!==false){G=B.getTime();var K=B.createQuery(F.form);if(F.params){if(K!=""&&!F.params.startWith("&")){K+="&"}K+=F.params}if(R!="post"&&K!=""){if(F.url.indexOf("?")==-1){F.url+="?"+K}else{F.url+=((F.url.endWith("?")||F.url.endWith("&"))?"":"&")+K}}if(I.inprocess){I.abort()}I.inprocess=1;if(F.text||F.xml){D({readyState:4,status:F.status==null?200:F.status,responseText:F.text,responseXML:F.xml});F.text=F.xml=null}else{if(!H){H=B.getXHR()}try{H.onprogress=function(S){I.fireEvent("progress",{id:J,xhr:I,event:S,position:S.position,total:S.totalSize,percent:Math.round(100*S.position/S.totalSize)})}}catch(Q){}var N=(B.browser.msie&&location.protocol=="file:"&&F.url.startWith("/")?"file://":"")+F.url;if(F.user){H.open(R.toUpperCase(),N,F.async,F.user,F.pswd)}else{H.open(R.toUpperCase(),N,F.async)}H.onreadystatechange=F.async?D:function(){};var M="setRequestHeader";H[M]("AJAX_ENGINE","Fullajax");if(F.anticache!=null?F.anticache:C.DAX_ANTICACHE){H[M]("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT")}H[M]("HTTP_X_REQUESTED_WITH","XMLHttpRequest");if(F.headers){for(var P in F.headers){H[M](P,F.headers[P])}}if(R=="post"){H[M]("Content-Type","application/x-www-form-urlencoded; Charset="+C.CHARSET)}B.showLoading(I.inprocess,I.getLoader());H.send((R=="post")?K:null);if(!F.async){D()}}if(C.DEBUG_AJAX){log(R+" "+F.url+" params:"+K+" id:"+J)}I.fireEvent("afterrequest",O)}}catch(Q){I.abort();error(Q);throw Q}};this.getLoader=function(){if(!I.loader){I.loader=F.loader==null?B.getLoader(J,1):B.get(F.loader)}return I.loader};this.abort=function(){I.inprocess=0;if(!H){return }try{H.isAbort=1;H.abort()}catch(K){}H=null;B.showLoading(0,I.getLoader())};this.destroy=function(){B.Data.thread[J]=null;delete B.Data.thread[J]}},showLoading:function(D,H){var F=H?H.style:0;if(F){if(D){if(F.visibility){F.visibility="visible"}else{F.display="block"}}else{function G(K,I){for(var J in K){if(K[J].getLoader()!=H){continue}if(K[J]&&K[J].isProcess()){return 1}}}if(!G(B.Data.thread,1)&&!G(B.Html.thread)){if(F.visibility){F.visibility="hidden"}else{F.display="none"}}}}},getLoader:function(G,D){var F=B.get;if(G){G=F((typeof G=="string"?G:G.id)+C.loaderSufix)}return G||F(D?C.loader2:C.loader)||F(D?C.loader:C.loader2)},encode:encodeURIComponent,decode:decodeURIComponent,createQuery:function(L,D){L=B.get(L);if(!L){return""}if(!D){D={}}var N=[],M=[],T=B.encode,G=L.getElementsByTagName("input");for(var R=0;R<G.length;R++){var F=G[R],H=F.type.toLowerCase(),W=F.name?F.name:F.id,O=T(F.value);if(!W){continue}W=T(W);switch(H){case"text":case"password":case"hidden":case"button":N.push(W);M.push(O);break;case"checkbox":case"radio":if(F.checked){N.push(W);M.push((O==null||O=="")?F.checked:O)}break}}var V=L.getElementsByTagName("select");for(var R=0;R<V.length;R++){var P=V[R],H=P.type.toLowerCase(),W=P.name?P.name:P.id;if(!W||P.selectedIndex==-1){continue}if(H=="select-multiple"){for(var Q=0,S=P.options.length;Q<S;Q++){if(P.options[Q].selected){N.push(W);M.push(T(P.options[Q].value))}}}else{N.push(T(W));M.push(T(P.options[P.selectedIndex].value))}}var K=L.getElementsByTagName("textarea");for(var R=0;R<K.length;R++){var J=K[R],W=J.name?J.name:J.id;if(!W){continue}N.push(T(W));M.push(T(J.value))}var I=[];for(var R=0,S=N.length;R<S;R++){if(D.skipEmpty&&M[R]==""){continue}I.push(N[R]+"="+M[R])}var U=I.join("&")+(L.submitValue||"");L.submitValue=null;return U},addEventsListener:function(D){if(D.prototype){D=D.prototype}D.on=function(F,J,K){if(!(F instanceof Array)){F=[F]}for(var H=0,G=F.length;H<G;H++){var I=F[H];if(!K){this.un(I,J)}if(!this.events){this.events={}}if(!this.events[I]){this.events[I]=[]}this.events[I].push(J)}};D.un=function(F,K,I){if(!(F instanceof Array)){F=[F]}for(var H=0,G=F.length;H<G;H++){var J=F[H];if(!K){return this.unall(J)}var L=this.events?this.events[J]:null;if(L){B.arrayRemoveOf(L,K,!I);this.events[J]=L}}};D.unall=function(F){if(this.events){if(F){delete this.events[F]}else{delete this.events}}};D.fireEvent=function(M,H){var F=this.events?this.events[M]:null;if(F){var K=null,G=[].slice.call(arguments);G.shift();G.push(M);for(var J=0;J<F.length;J++){try{var L=F[J].apply(this,G);if(K!==false&&L!=null){K=L}}catch(I){error(I)}}return K}};return D},addContainerListener:function(F){if(F.prototype){F=F.prototype}var G={},D={};F.register=function(I){var L=G[I.id];if(L){for(var K in L){for(var J=0,H=L[K].length;J<H;J++){I.on(K,L[K][J])}}}for(var K in D){var L=D[K];for(var J=0,H=L.length;J<H;J++){I.on(K,L[J])}}};F.on=function(H,L,K,N){if(!(H instanceof Array)){H=[H]}for(var J=0,I=H.length;J<I;J++){var M=H[J];if(!G[M]){G[M]={}}if(!G[M][L]){G[M][L]=[]}G[M][L].push(K);if(this.thread[M]){this.thread[M].on(L,K,N)}}};F.onall=function(K,J,L){if(!D[K]){D[K]=[]}D[K].push(J);var I=this.thread;for(var H in I){if(I[H]){I[H].on(K,J,L)}}};F.unall=function(M,L,J){if(M){if(L){var H=D[M];B.arrayRemoveOf(H,L,!J);D[M]=H}else{D[M]=[]}}else{D={}}var K=this.thread;for(var I in K){if(K[I]){K[I].un(M,L,J)}}};F.un=function(O,H,J,Q){if(!(O instanceof Array)){O=[O]}for(var N=0,K=O.length;N<K;N++){var I=O[N];if(!J){if(I){if(G[I]){if(H){delete G[I][H]}else{delete G[I]}}}else{G={}}var P={};if(I){P[I]=this.thread[I]}else{P=this.thread}for(var M in P){if(P[M]){P[M].unall(H)}}}else{var L=G[I]?G[I][H]:null;if(L){B.arrayRemoveOf(L,J,!Q);G[I][H]=L}if(this.thread[I]){this.thread[I].un(H,J,Q)}}}};F.fireEvent=function(J,I,H){if(this.thread[J]){return this.thread[J].fireEvent(I,H)}};return F},Data:{thread:{}},Loader:{show:function(){B.showLoading(1,B.getLoader())},hide:function(){B.showLoading(0,B.getLoader())}},parseUri:function(J,G){var D={strictMode:0,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var K=G?G:D,I=K.parser[K.strictMode?"strict":"loose"].exec(J);for(var F=0,H={};F<14;F++){H[K.key[F]]=I[F]||""}H[K.q.name]={};H[K.key[12]].replace(K.q.parser,function(M,L,N){if(L){H[K.q.name][L]=N}});return H},showMessage:function(F,D,G){if(D==0){return }alert("Error "+D+" : "+F+"\n"+G)},genId:function(){return E("genid"+C.sprt)+(B.lastGenId?++B.lastGenId:B.lastGenId=1)}});var C=B.Default;var E=function(D){return C.prefix+C.sprt+D};var A=B.placeMark=function(G,D){var F=E("place"+C.sprt+"mark");if(G&&D!=null){G[F]=D}return G?(D==null?G[F]:G):F}})(SRAX);SRAX.init()};